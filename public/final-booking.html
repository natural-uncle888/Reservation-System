<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="theme-color" content="#2563eb"/>
<title>å®‰æ’æ™‚æ®µå¡«å¯«</title>
<link rel="icon" type="image/png" href="https://res.cloudinary.com/dijzndzw2/image/upload/v1757176751/logo-3_hddq08.png"/>
  <style>
    :root{--brand:#2563eb;--ink:#111827;--muted:#6b7280;--card:#f9fafb;--line:#e5e7eb}
    body{font-family:"Noto Sans TC",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;margin:0;color:var(--ink)}
    .wrap{max-width:1024px;margin:0 auto;padding:18px 16px}
    h1{margin:0 0 8px;color:var(--brand)}
    p.desc{margin:0 0 12px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .section{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:16px}
    .section h2{margin:0 0 8px;color:var(--brand);font-size:1.1rem}
    .group{display:flex;flex-direction:column;gap:8px}
    label{display:flex;align-items:center;gap:8px}
    input[type="text"],textarea{padding:10px;border:1px solid #d1d5db;border-radius:8px;width:100%}
    table{width:100%;border-collapse:collapse;font-size:.95rem}
    th,td{border-bottom:1px solid #eee;padding:8px;text-align:left;vertical-align:top}
    .nav{display:flex;gap:12px;margin-top:16px}
    .nav a,.nav button{flex:1;text-align:center;padding:12px 16px;background:var(--brand);color:#fff;border-radius:10px;text-decoration:none;border:none;cursor:pointer
  /* Force identical typography for <a> and <button> */
  font: 500 16px/1.5 "Noto Sans TC", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  letter-spacing: 0;
}
    .nav a:hover,.nav button:hover{background:#1e40af}
    .ok{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);align-items:center;justify-content:center}
    .ok .modal{background:#fff;border-radius:12px;padding:24px;max-width:420px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    details{background:#fff;border:1px dashed var(--line);border-radius:10px;padding:10px;margin-top:8px}
    details>summary{cursor:pointer;font-weight:700}
  

/* å…¶ä»–æŒ‡å®šæ™‚é–“è¼¸å…¥æ¡†ç¾åŒ–ä¿®æ­£ç‰ˆ */
#time_other {
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  width: 100%; /* ç›´æ¥å¡«æ»¿å®¹å™¨ï¼Œé¿å…è¶…å‡º */
  font-size: 0.95rem;
  color: #111827;
  box-sizing: border-box; /* ç¢ºä¿é‚Šæ¡†èˆ‡å…§è·ä¸æœƒå½±éŸ¿å¯¬åº¦ */
  margin-left: 0; /* ç§»é™¤å¤šé¤˜å¤–è· */
}
#time_other:focus {
  outline: none;
  border-color: #2563eb;
  box-shadow: 0 0 0 2px rgba(37,99,235,0.2);
}


/* å…¶ä»–å‚™è¨»èªªæ˜è¼¸å…¥æ¡†å°é½Šä¿®æ­£ */
textarea[name="note"] {
  display: block;
  width: 100%;
  box-sizing: border-box;
  margin: 0;       /* ç§»é™¤å¤šé¤˜å¤–è· */
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
}


/* Normalize button defaults to match links */
button {
  font: inherit;
  -webkit-font-smoothing: inherit;
  -moz-osx-font-smoothing: inherit;
}

</style>
<link rel="stylesheet" href="mobile.css"/>
</head>
<body>
  <div class="wrap">
    <h1>å®‰æ’æ™‚æ®µå¡«å¯«</h1>
    <p class="desc">è«‹é¸æ“‡å¯å®‰æ’æ™‚æ®µï¼Œä¸¦è£œå……å…¶ä»–èªªæ˜ã€‚å³å´å¯å³æ™‚é è¦½å¡«å¯«çš„å…§å®¹ã€‚</p>

    <div class="grid">
      <div class="section">
        <h2>å¯å®‰æ’æ™‚æ®µï¼ˆå¯è¤‡é¸ï¼‰</h2>
        <div class="group" id="timeslot">
          <label><input type="checkbox" name="timeslot" value="å¹³æ—¥">å¹³æ—¥</label>
          <label><input type="checkbox" name="timeslot" value="å‡æ—¥">å‡æ—¥</label>
          <label><input type="checkbox" name="timeslot" value="ä¸Šåˆ">ä¸Šåˆ</label>
          <label><input type="checkbox" name="timeslot" value="ä¸‹åˆ">ä¸‹åˆ</label>
          <label><input type="checkbox" name="timeslot" value="æ™šä¸Š">æ™šä¸Š</label>
          <label><input type="checkbox" name="timeslot" value="çš†å¯">çš†å¯</label>
          <label><input type="checkbox" name="timeslot" value="å…¶ä»–æŒ‡å®šæ™‚é–“" data-other-id="time_other">å…¶ä»–æŒ‡å®šæ™‚é–“</label>
          <input id="time_other" name="time_other" placeholder="ä¾‹å¦‚ 6/9 09:00â€“11:00" />
        </div>

        <h2>å…¶ä»–å‚™è¨»èªªæ˜</h2>
        <textarea name="note" rows="4" placeholder="å¯è£œå……ç¤¾å€åœè»Šã€é–€ç¦ã€å¯µç‰©ã€è¯çµ¡å‰éœ€ç°¡è¨Šå‘ŠçŸ¥ç­‰è³‡è¨Š"></textarea>

        <details><summary>é€å‡ºå¾Œæµç¨‹</summary><p>æˆ‘å¸å°‡æ”¶åˆ°æ‚¨çš„é ç´„è³‡æ–™ï¼Œäººå“¡æœƒæ–¼ã€Œæ–¹ä¾¿è¯ç¹«æ™‚é–“ã€å…§èˆ‡æ‚¨è¯çµ¡ï¼Œç¢ºèªç´°ç¯€èˆ‡åˆ°åºœæ™‚é–“ã€‚</p></details>
      </div>

      <div class="section">
        <h2>é€å‡ºå‰é è¦½</h2>
        <table id="preview"><tbody></tbody></table>
      </div>
    </div>

    <div class="nav">
      <a href="contact.html" id="back">â† è¿”å›ä¸Šä¸€æ­¥</a>
      <button id="submit">å®Œæˆå¡«å¯«ä¸¦é€å‡º</button>
    </div>
  </div>

  <div class="ok" id="ok">
    <div class="modal">
      <h3>å·²é€å‡º</h3>
      <p>æ„Ÿè¬æ‚¨å¡«å¯«é ç´„è³‡æ–™ğŸ™</p>
      <p>æˆ‘å€‘å°‡ç›¡å¿«èˆ‡æ‚¨è¯ç¹«ï¼Œå®‰æ’æœ€åˆé©çš„æ¸…æ´—æœå‹™æ™‚æ®µï¼</p>
    </div>
  </div>

  <script>
  (function(){
    const KEY='BOOKING_DATA';
    const FN='/submit';
    const $=s=>document.querySelector(s);
    const $$=s=>Array.prototype.slice.call(document.querySelectorAll(s));

    function getLS(){
      try{ return JSON.parse(localStorage.getItem(KEY)||'{}'); }catch(e){ return {}; }
    }
    function collectForm(root=document){
      const out={};
      $$('input[name],select[name],textarea[name]', root).forEach(el=>{
        const n=el.name; if(!n) return;
        if(el.type==='checkbox'){
          if(!el.checked) return;
          let v=el.value;
          const oid=el.dataset.otherId;
          if(oid){
            const extra = ($('#'+oid)?.value||'').trim();
            if(extra) v = v+'ï¼š'+extra;
          }
          (out[n]||(out[n]=[])).push(v);
        }else{
          const v=(el.value||'').trim();
          if(v) out[n]=v;
        }
      });
      return out;
    }
    function preview(payload){
      const tbody = $('#preview tbody'); tbody.innerHTML='';
      const show = (k, label)=>{
        const v = payload[k];
        if(v==null || v==='' || (Array.isArray(v) && !v.length)) return;
        const txt = Array.isArray(v) ? v.join('ã€') : v;
        const tr = document.createElement('tr');
        tr.innerHTML = '<th>'+label+'</th><td>'+txt+'</td>';
        tbody.appendChild(tr);
      };
      show('service_category','æœå‹™é¡åˆ¥');
      show('ac_type','å†·æ°£é¡å‹');
      show('ac_count','æ¸…æ´—æ•¸é‡');
      show('indoor_floor','å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤');
      show('ac_brand','å†·æ°£å“ç‰Œ');
      show('ac_transformer_series','æ˜¯å¦ç‚ºè®Šå½¢é‡‘å‰›ç³»åˆ—');
      show('anti_mold','é˜²éœ‰æŠ—èŒ');
      show('ozone','è‡­æ°§æ¶ˆæ¯’');
      show('washer_count','æ´—è¡£æ©Ÿå°æ•¸');
      show('washer_floor','æ´—è¡£æ©Ÿæ¨“å±¤');
      show('tank_count','æ°´å¡”é¡†æ•¸');
      show('pipe_service','æ°´ç®¡æ¸…æ´—æˆ¶å‹');
      show('pipe_reason','æ°´ç®¡æ¸…æ´—åŸå› ');
      show('contact_method','è¯ç¹«æ–¹å¼');
      show('social_name','LINE/FB åç¨±');
      show('name','é¡§å®¢å§“å');
      show('phone','è¯ç¹«é›»è©±');
      show('address','åœ°å€');
      show('housing_type','å±…ä½åœ°å‹æ…‹');
      show('contact_time_preference','æ–¹ä¾¿è¯ç¹«æ™‚é–“');
      show('timeslot','å¯å®‰æ’æ™‚æ®µ');
      show('note','å‚™è¨»');
    }

    function buildPayload(){
      const ls = getLS();
      const form = collectForm(document);
      const merged = Object.assign({}, ls, form, { _page:{title:document.title,path:location.pathname,url:location.href}, _final:true });
      return merged;
    }

    function refresh(){
      const p = buildPayload();
      window.lastPayload = p;
      preview(p);
    }

    refresh();
    document.addEventListener('change', refresh);
    document.addEventListener('input', refresh);

    $('#back')?.addEventListener('click', ()=>{
      localStorage.setItem(KEY, JSON.stringify(buildPayload()));
    }, {capture:true});

    $('#submit').addEventListener('click', async ()=>{
      const payload = buildPayload();
      try{
        const res = await fetch(FN,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        const t = await res.text();
        if(!res.ok) throw new Error('['+res.status+'] '+t);
        $('#ok').style.display='flex';
        setTimeout(()=>{ localStorage.removeItem(KEY); location.href='index.html'; }, 1200);
      }catch(err){
        alert('æäº¤å¤±æ•—ï¼š'+err.message);
      }
    });
  })();
  </script>
</body>
</html>
