<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#2563eb" />
  <title>å†·æ°£æ¸…æ´—ï½œé ç´„è¡¨å–®</title>
  <link rel="icon" type="image/png" href="https://res.cloudinary.com/dijzndzw2/image/upload/v1757176751/logo-3_hddq08.png"/>

  <style>
    /* ===== Scoped Reset (åªä½œç”¨åœ¨ .acv2) ===== */
    .acv2, .acv2 *, .acv2 *::before, .acv2 *::after { box-sizing: border-box; }
    .acv2 { line-height: 1.5; -webkit-text-size-adjust: 100%; color: #111827;  font-family:"Noto Sans TC",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif; --brand-700:#1e40af; }
    .acv2 h1, .acv2 h2, .acv2 h3, .acv2 h4, .acv2 p { margin: 0; }
    .acv2 img { max-width: 100%; height: auto; display: block; }
    .acv2 a { color: inherit; text-decoration: none; }
    .acv2 input, .acv2 select, .acv2 textarea, .acv2 button { font: inherit; color: inherit; }
    .acv2 table, .acv2 input, .acv2 select, .acv2 textarea, .acv2 button { max-width: 100%; }

    /* ===== Theme tokens ===== */
    .acv2 { --brand:#2563eb; --brand-700:#1e40af; --ink:#111827; --muted:#6b7280; --card:#f9fafb; --line:#e5e7eb; }

    /* ===== Layout ===== */
    .acv2 .wrap { max-width: 960px; margin: 0 auto; }
    .acv2 .header { padding: 22px 16px; border-bottom: 1px solid var(--line); background: #fff; }
    .acv2 .header h1 { color: var(--brand); font-size: 1.5rem; font-weight: 800; }
    .acv2 .desc { color: var(--muted); margin-top: 6px; }
    .acv2 form { max-width: 960px; margin: 16px auto; padding: 0 16px; }

    /* ===== Sections ===== */
    .acv2 .section { background: var(--card); border: 1px solid var(--line); border-radius: 12px; padding: 16px; margin: 16px 0; }
    .acv2 .section h2 { color: var(--brand); font-size: 1.1rem; margin: 0 0 8px; }
    .acv2 .section h2.req::after { content: " *"; color: #dc2626; margin-left: 4px; font-weight: 700; }
    .acv2 p.help { margin: 6px 0 0; color: var(--muted); font-size: .95rem; }

    /* ===== Group & Option Cards ===== */
    .acv2 .group { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 14px; margin-bottom: 10px; }
    .acv2 .group.model-group { display: flex; flex-direction: column; gap: 12px; }

    /* æ‰‹æ©Ÿï¼šé è¨­æ‰€æœ‰ç¾¤çµ„ç¶­æŒ 2 æ¬„ï¼Œåƒ… .onecol-mobile æ”¹ç‚º 1 æ¬„ */
    @media (max-width: 640px) {
      .acv2 .group { grid-template-columns: repeat(2, minmax(0,1fr)); }
      .acv2 .group.onecol-mobile { grid-template-columns: 1fr; }
    }

    .acv2 .option-card { width: 100%; }
    .acv2 .option-card { display: flex; align-items: center; gap: 14px; background: #fff; border: 2px solid var(--line); border-radius: 16px; padding: 16px 14px; font-size: 1.13rem; box-shadow: 0 1px 8px rgba(0,0,0,0.04); cursor: pointer; min-height: 48px; transition: border .13s, box-shadow .13s, background .12s; position: relative; }
    .acv2 .option-card:active { background: #e0e7ff; border-color: var(--brand); }
    .acv2 .option-card input[type="radio"], .acv2 .option-card input[type="checkbox"] { accent-color: var(--brand); width: 22px; height: 22px; margin-right: 6px; margin-left: 0; flex-shrink: 0; }
    .acv2 .option-card.selected { border: 2.5px solid var(--brand); background: #e0e7ff; box-shadow: 0 2px 12px rgba(37,99,235,0.10); }
    .acv2 .option-card img.opt-img { width: 88px; border-radius: 10px; margin-top: 0; border:1px solid var(--line); padding:2px; background:#fff; }

    /* ===== Hidden inputs for "å…¶ä»–" - è† å›Šå¼ ===== */
    .acv2 .hidden-input { display: none; margin: 10px 0 0 0; grid-column: 1 / -1; }
    .acv2 .hidden-input input {
      width: 100%;
      max-width: 520px;
      padding: 12px 16px;
      border: 1.5px solid #cbd5e1;
      border-radius: 9999px;
      font: inherit;
      font-size: 1rem;
      line-height: 1.5;
    }
    .acv2 .hidden-input input::placeholder { color: #9ca3af; font-size: 1rem; }

    /* ===== Aside / Tips ===== */
    .acv2 .aside { display: grid; gap: 6px; margin-top: 8px; }
    .acv2 .aside .tip { background: #fff; border: 1px solid var(--line); border-radius: 10px; padding: 10px; color: #6b7280; font-size: .92rem; }
    .acv2 details { background: #fff; border: 1px dashed var(--line); border-radius: 10px; padding: 10px; }
    .acv2 details > summary { cursor: pointer; font-weight: 700; color: var(--ink); }
    .acv2 .aside .tip img.opt-img { width: 450px; height: auto; border:1px solid var(--line); border-radius:8px; margin-top:6px; padding:2px; background:#fff; }

    /* ===== Nav ===== */
    

    /* ===== FAB Home (è¡Œå‹•) ===== */
    .acv2 .fab-home { position: fixed; right: 18px; bottom: 72px; width: 54px; height: 54px; background: var(--brand); color: #fff; border-radius: 50%; box-shadow: 0 2px 12px rgba(37,99,235,0.08); display: flex; align-items: center; justify-content: center; font-size: 2.1em; z-index: 1010; border: none; }
    .acv2 .fab-home:active { background: #1d4ed8; transform: scale(0.92); }
    @media (min-width: 768px) { .acv2 .fab-home { display: none; } }

    /* ===== Error Style ===== */
    .acv2 .input-error { color: #dc2626; background: #fef2f2; border-radius: 8px; padding: 5px 10px; margin-top: 4px; font-size: .93rem; font-weight: 600; }
    .acv2 .form-row.error input, .acv2 .form-row.error textarea, .acv2 .form-row.error select { border: 2px solid #dc2626; background: #fef2f2; }
  
    

  
    /* === Nav copied to match contact.html exactly === */
    

  
    /* === addon-service åŒæ¬¾åº•éƒ¨å°è¦½ï¼ˆæ¡Œæ©Ÿ/æ‰‹æ©Ÿä¸€è‡´ï¼‰ === */
    .acv2 .nav { display: flex; gap: 12px; margin-top: 22px; }
    .acv2 .nav a { 
      flex: 1; text-align: center; padding: 12px 16px; 
      background: var(--brand); color: #fff; border-radius: 10px; 
      text-decoration: none; 
    }
    .acv2 .nav a:hover { background: #1e40af; }

  </style>
</head>
<body>
  <div class="acv2">
    <div class="header">
      <div class="wrap">
        <h1>å†·æ°£æ¸…æ´—ï½œé ç´„è¡¨å–®</h1>
        <p class="desc">è«‹æä¾›æ©Ÿå‹èˆ‡æ•¸é‡ï¼Œä»¥ä¾¿å®‰æ’åˆé©äººå“¡èˆ‡æ™‚é–“ã€‚è‹¥é¸æ“‡ã€Œä»¥ä¸Šï¼å…¶ä»–ã€ï¼Œè«‹è¼¸å…¥å¯¦éš›æ•¸å­—æˆ–å“ç‰Œã€‚</p>
      </div>
    </div>

    <form id="booking-form" action="addon-service.html" method="get" novalidate>
      <input type="hidden" name="service_category" value="å†·æ°£æ¸…æ´—" />

      <div class="section">
        <h2 class="req">å†·æ°£é¡å‹</h2>
        <div class="group onecol-mobile">
          <label class="option-card">
            <input type="radio" name="ac_type" value="åˆ†é›¢å¼å†·æ°£"  />åˆ†é›¢å¼å†·æ°£
            <img class="opt-img" alt="åˆ†é›¢å¼å†·æ°£ç¤ºæ„åœ–" src="imagessplit-ac.jpg" />
          </label>
          <label class="option-card">
            <input type="radio" name="ac_type" value="åŠéš±å¼å†·æ°£" />åŠéš±å¼å†·æ°£
            <img class="opt-img" alt="åŠéš±å¼å†·æ°£ç¤ºæ„åœ–" src="imagesceiling-ac.jpg" />
          </label>
        </div>
        <p class="help">è‹¥åŒå ´ä¸åŒå‹å¼ï¼Œè«‹åœ¨æœ€çµ‚é å‚™è¨»æ¬„è£œå……ã€‚</p>
      </div>

      <div class="section">
        <h2 class="req">æ¸…æ´—æ•¸é‡</h2>
        <div class="group">
          <label class="option-card"><input type="radio" name="ac_count" value="1å°"  />1 å°</label>
          <label class="option-card"><input type="radio" name="ac_count" value="2å°" />2 å°</label>
          <label class="option-card"><input type="radio" name="ac_count" value="3å°" />3 å°</label>
          <label class="option-card"><input type="radio" name="ac_count" value="4å°" />4 å°</label>
          <label class="option-card"><input type="radio" name="ac_count" value="5å°" />5 å°</label>
          <label class="option-card"><input type="radio" name="ac_count" value="5å°ä»¥ä¸Š" data-other-id="ac_count_other" />5 å°ä»¥ä¸Š</label>
          <div id="ac_count_other_wrap" class="hidden-input">
            <input type="number" id="ac_count_other" name="ac_count_other" min="6" placeholder="è«‹è¼¸å…¥å¯¦éš›å°æ•¸ï¼ˆâ‰¥6ï¼‰" />
          </div>
        </div>
      </div>

      <div class="section">
        <h2 class="req">å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤ï¼ˆå¯è¤‡é¸ï¼‰</h2>
        <div class="group">
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="1æ¨“" />1 æ¨“</label>
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="2æ¨“" />2 æ¨“</label>
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="3æ¨“" />3 æ¨“</label>
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="4æ¨“" />4 æ¨“</label>
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="5æ¨“" />5 æ¨“</label>
          <label class="option-card"><input type="checkbox" name="indoor_floor" value="5æ¨“ä»¥ä¸Š" data-other-id="indoor_floor_other" />5 æ¨“ä»¥ä¸Š</label>
          <div id="indoor_floor_other_wrap" class="hidden-input">
            <input type="text" id="indoor_floor_other" name="indoor_floor_other" placeholder="è«‹è¼¸å…¥æ¨“å±¤ï¼ˆå¦‚ 6æ¨“ã€é ‚æ¨“åŠ è“‹ï¼‰" />
          </div>
        </div>
      </div>

      <div class="section">
        <h2 class="req">å†·æ°£å“ç‰Œï¼ˆå¯è¤‡é¸ï¼‰</h2>
        <div class="group">
          <label class="option-card"><input type="checkbox" name="ac_brand" value="HITACHI æ—¥ç«‹" />HITACHI æ—¥ç«‹</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="Panasonic åœ‹éš›ç‰Œ" />Panasonic åœ‹éš›ç‰Œ</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="DAIKIN å¤§é‡‘" />DAIKIN å¤§é‡‘</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="MITSUBISHI ä¸‰è±" />MITSUBISHI ä¸‰è±</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="FUJITSU å¯Œå£«é€š" />FUJITSU å¯Œå£«é€š</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="LG" />LG</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="TECO æ±å…ƒ" />TECO æ±å…ƒ</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="SANLUX ä¸‰æ´‹" />SANLUX ä¸‰æ´‹</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="SAMPO è²å¯¶" />SAMPO è²å¯¶</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="Heran ç¦¾è¯" />Heran ç¦¾è¯</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="Kolin æ­Œæ—" />Kolin æ­Œæ—</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="TATUNG å¤§åŒ" />TATUNG å¤§åŒ</label>
          <label class="option-card"><input type="checkbox" name="ac_brand" value="å…¶ä»–" data-other-id="ac_brand_other" />å…¶ä»–</label>
          <div id="ac_brand_other_wrap" class="hidden-input">
            <input type="text" id="ac_brand_other" name="ac_brand_other" placeholder="è«‹è¼¸å…¥å“ç‰Œ" />
          </div>
        </div>
      </div>

      <div class="section">
        <h2 class="req">æ˜¯å¦ç‚ºã€Œè®Šå½¢é‡‘å‰›ç³»åˆ—ã€å†·æ°£æ©Ÿå‹ï¼Ÿ</h2>
        <div class="group model-group">
          <label class="option-card"><input type="radio" name="ac_transformer_series" value="æ˜¯"  />æ˜¯</label>
          <label class="option-card"><input type="radio" name="ac_transformer_series" value="å¦" />å¦</label>
          <label class="option-card"><input type="radio" name="ac_transformer_series" value="ä¸æ¸…æ¥šï¼ˆç¾å ´ç”±äººå“¡åˆ¤æ–·ï¼‰" />ä¸æ¸…æ¥šï¼ˆç¾å ´ç”±äººå“¡åˆ¤æ–·ï¼‰</label>
        
        <div class="aside">
          <div class="tip">
            <strong>ä»€éº¼æ˜¯ã€Œè®Šå½¢é‡‘å‰›ç³»åˆ—ã€ï¼Ÿ</strong>
            <p class="help">ç‰¹å®šç³»åˆ—ä¹‹æ©Ÿå‹æ‹†è£æµç¨‹è¼ƒä¸åŒã€‚è‹¥ä¸ç¢ºå®šè«‹é¸ã€Œä¸æ¸…æ¥šã€ï¼Œç”±ç¾å ´äººå“¡å”åŠ©åˆ¤æ–·ã€‚</p>
            <img class="opt-img" alt="å¸¸è¦‹è®Šå½¢é‡‘å‰›ç³»åˆ—åƒè€ƒç…§ç‰‡" src="imagestransformer-ac.jpg" />
          </div>
        </div>

      
      
      
      
      
      <div class="nav">
        <a href="index.html" id="back">å›é¦–é </a>
        <a href="addon-service.html" id="next">ä¸‹ä¸€æ­¥</a>
      </div>
    </form>





    <a class="fab-home" href="index.html" aria-label="å›é¦–é ">ğŸ </a>
  </div>

  <script>
    (function(){
      const KEY = 'BOOKING_DATA';
      const form = document.getElementById('booking-form');

      function toggleOtherWrap(name){
        form.querySelectorAll('input[name="'+name+'"]').forEach(el=>{
          const id = el.dataset.otherId;
          const wrap = id && document.getElementById(id + '_wrap');
          if(wrap) wrap.style.display = el.checked ? 'block' : 'none';
        });
      }
      function collect(){
        const out = { service_category: 'å†·æ°£æ¸…æ´—' };
        form.querySelectorAll('input[name],select[name],textarea[name]').forEach(el=>{
          const n = el.name; if(!n) return;
          if(el.type==='radio'){
            if(!el.checked) return;
            let v = el.value || '';
            const oid = el.dataset.otherId;
            if(oid){
              const extra = (form.querySelector('#'+oid)?.value||'').trim();
              if(extra) v = v + 'ï¼š' + extra;
            }
            out[n] = v;
          }else if(el.type==='checkbox'){
            if(!el.checked) return;
            let v = el.value || '';
            const oid = el.dataset.otherId;
            if(oid){
              const extra = (form.querySelector('#'+oid)?.value||'').trim();
              if(extra) v = v + 'ï¼š' + extra;
            }
            (out[n]||(out[n]=[])).push(v);
          }else{
            const v = (el.value||'').trim();
            if(v) out[n] = v;
          }
        });
        return out;
      }
      function save(part){
        try{
          const prev = JSON.parse(localStorage.getItem(KEY)||'{}');
          localStorage.setItem(KEY, JSON.stringify(Object.assign(prev, part)));
        }catch(e){}
      }
      ['ac_count','indoor_floor','ac_brand'].forEach(n=>{
        form.querySelectorAll('input[name="'+n+'"]').forEach(el=>{
          el.addEventListener('change', ()=>{
            toggleOtherWrap(n);
            save(collect());
          });
        });
        toggleOtherWrap(n);
      });
      form.addEventListener('input', ()=> save(collect()));
      

      window.debugCollectAC = ()=>collect();
      window.debugLS = ()=>JSON.parse(localStorage.getItem(KEY)||'{}');
    })();
  </script>
  <script>
    (function() {
      const form = document.getElementById('booking-form');
      function anyChecked(name) {
        return Array.from(form.querySelectorAll('input[name="' + name + '"]')).some(i=> i.checked);
      }
      , true);
      }
    })();
  </script>
  <script>
    // å¡ç‰‡é¸ä¸­è¦–è¦ºç‹€æ…‹ï¼ˆåƒ…é™ .acv2 å…§éƒ¨ï¼‰
    document.addEventListener('DOMContentLoaded', function () {

  // å…ˆæŠŠ <a id="next"> çš„é è¨­å°é é—œæ‰ï¼Œé¿å…ä»»ä½•å…¶ä»–ç›£è½å™¨æˆ–ç€è¦½å™¨é è¨­å‹•ä½œæŠŠä½ å¸¶èµ°
  (function(){
    const a = document.getElementById('next');
    if (a) {
      const href = a.getAttribute('href');
      if (href && href !== '#' && href !== 'javascript:void(0)') {
        a.dataset.nextHref = href;
        a.setAttribute('href', '#');
      }
    }
  })();

      const root = document.querySelector('.acv2');
      root.querySelectorAll('.group').forEach(function(group) {
        group.querySelectorAll('input[type="radio"],input[type="checkbox"]').forEach(function(input){
          input.addEventListener('change', function(){
            if(input.type === 'radio') { group.querySelectorAll('.option-card').forEach(function(card){ card.classList.remove('selected'); }); }
            if(input.checked) input.closest('.option-card').classList.add('selected');
            else input.closest('.option-card').classList.remove('selected');
          });
          if(input.checked) input.closest('.option-card').classList.add('selected');
        });
      });
    });
  </script>

  <script>
    (function(){
      var form = document.getElementById('booking-form');
      var next = document.getElementById('next');
      if(next && form){
        next.addEventListener('click', function(e){
          e.preventDefault();
          if (form.requestSubmit) form.requestSubmit();
          else form.submit();
        }, {capture:true});
      }
    })();
  </script>


<script>
// å…±äº«é©—è­‰èˆ‡é˜²é‡è¤‡å½ˆçª—å·¥å…·ï¼ˆæ”¹ç‚ºä½¿ç”¨å…¨åŸŸå»æŠ–ç‰ˆæœ¬ï¼‰
function runValidation(){
  // éœ€è¦çš„å·¥å…·å‡½å¼ï¼ˆèˆ‡åŸæœ¬ä¸€è‡´ï¼‰
  function requireRadio(name, label){
    var picked = document.querySelector('input[type="radio"][name="'+name+'"]:checked');
    if(!picked){ return { ok:false, msg:'è«‹é¸æ“‡ã€'+label+'ã€' }; }
    var oid = picked && picked.dataset.otherId;
    if(oid){
      var other = document.getElementById(oid);
      if(other && !(other.value||'').trim()){
        return { ok:false, msg:'æ‚¨é¸æ“‡äº†ã€'+label+'ã€çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é¸é …ï¼Œè«‹è£œå……èªªæ˜' };
      }
    }
    return { ok:true };
  }
  function requireCheckbox(name, label){
    var checked = document.querySelectorAll('input[type="checkbox"][name="'+name+'"]:checked,'+
                                            'input[type="checkbox"][name="'+name+'[]"]:checked');
    if(checked.length===0){ return { ok:false, msg:'è«‹è‡³å°‘å‹¾é¸ä¸€å€‹ã€'+label+'ã€' }; }
    for(var i=0;i<checked.length;i++){
      var el = checked[i];
      var oid = el.dataset.otherId;
      if(oid){
        var other = document.getElementById(oid);
        if(other && other.offsetParent !== null && !(other.value||'').trim()){
          return { ok:false, msg:'æ‚¨å‹¾é¸äº†ã€'+label+'ã€çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é¸é …ï¼Œè«‹è£œå……èªªæ˜' };
        }
      }
    }
    return { ok:true };
  }
  function requireVisibleOthers(){
    var nodes = document.querySelectorAll('.other-input');
    for (var i=0;i<nodes.length;i++){
      var el = nodes[i];
      var vis = el.classList.contains('show') || el.offsetParent !== null;
      if(vis && !(el.value||'').trim()){
        return { ok:false, msg:'æ‚¨é¸æ“‡äº†éœ€è£œå……çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é …ç›®ï¼Œè«‹å¡«å¯«èªªæ˜' };
      }
    }
    return { ok:true };
  }

  var r, valid = true, msg = '';

  // 0) æ˜¯å¦ç‚ºè®Šå½¢é‡‘å‰›ç³»åˆ—ï¼ˆradioï¼‰
  r = requireRadio('ac_transformer_series','æ˜¯å¦ç‚ºè®Šå½¢é‡‘å‰›ç³»åˆ—'); if(!r.ok){ valid=false; msg=r.msg; }

  // 1) å†·æ°£é¡å‹ï¼ˆradioï¼‰
  if(valid){ r = requireRadio('ac_type','å†·æ°£é¡å‹'); if(!r.ok){ valid=false; msg=r.msg; } }

  // 2) æ¸…æ´—æ•¸é‡ï¼ˆradioï¼‰
  if(valid){ r = requireRadio('ac_count','æ¸…æ´—æ•¸é‡'); if(!r.ok){ valid=false; msg=r.msg; } }

  // 3) å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤ï¼ˆcheckbox ç¾¤çµ„ï¼‰ï¼šè‡³å°‘ä¸€å€‹
  if(valid){ r = requireCheckbox('indoor_floor','å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤'); if(!r.ok){ valid=false; msg=r.msg; } }

  // 4) å†·æ°£å“ç‰Œï¼ˆcheckbox ç¾¤çµ„ï¼‰ï¼šè‡³å°‘ä¸€å€‹
  if(valid){ r = requireCheckbox('ac_brand','å†·æ°£å“ç‰Œ'); if(!r.ok){ valid=false; msg=r.msg; } }

  // 5) é¡¯ç¤ºä¸­çš„ã€Œå…¶ä»–ã€è¼¸å…¥æ¡†éœ€å¡«å¯«
  if(valid){ r = requireVisibleOthers(); if(!r.ok){ valid=false; msg=r.msg; } }

  return { ok: valid, msg: msg };
}
</script>
<script>
  // === çµ±ä¸€èˆ‡ contact ç›¸åŒï¼šæŒ‰ä¸‹ã€Œä¸‹ä¸€æ­¥ã€æ‰åšé©—è­‰ï¼›å¤±æ•— alertï¼ŒæˆåŠŸæ‰å‰é€² ===
  document.addEventListener('DOMContentLoaded', function () {

  // å…ˆæŠŠ <a id="next"> çš„é è¨­å°é é—œæ‰ï¼Œé¿å…ä»»ä½•å…¶ä»–ç›£è½å™¨æˆ–ç€è¦½å™¨é è¨­å‹•ä½œæŠŠä½ å¸¶èµ°
  (function(){
    const a = document.getElementById('next');
    if (a) {
      const href = a.getAttribute('href');
      if (href && href !== '#' && href !== 'javascript:void(0)') {
        a.dataset.nextHref = href;
        a.setAttribute('href', '#');
      }
    }
  })();

    const nextBtn = document.getElementById('next');
    const form = document.querySelector('form');
    if (!nextBtn || !form) return;

    // å·¥å…·ï¼šæª¢æŸ¥ radio ç¾¤çµ„æ˜¯å¦å·²é¸
    function requireRadio(name, label){
      const picked = document.querySelector('input[type="radio"][name="'+name+'"]:checked');
      if(!picked){
        return { ok:false, msg:'è«‹é¸æ“‡ã€'+label+'ã€' };
      }
      const oid = picked && picked.dataset.otherId;
      if(oid){
        const other = document.getElementById(oid);
        if(other){
          const v = (other.value||'').trim();
          if(!v){
            return { ok:false, msg:'æ‚¨é¸æ“‡äº†ã€'+label+'ã€çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é¸é …ï¼Œè«‹è£œå……èªªæ˜' };
          }
        }
      }
      return { ok:true };
    }

    // å·¥å…·ï¼šæª¢æŸ¥ checkbox ç¾¤çµ„è‡³å°‘å‹¾ä¸€å€‹
    function requireCheckbox(name, label){
      // æ”¯æ´ name="group" èˆ‡ name="group[]"
      const checked = document.querySelectorAll('input[type="checkbox"][name="'+name+'"]:checked,'+
                                                'input[type="checkbox"][name="'+name+'[]"]:checked');
      if(checked.length===0){
        return { ok:false, msg:'è«‹è‡³å°‘å‹¾é¸ä¸€å€‹ã€'+label+'ã€' };
      }
      for(const el of checked){
        const oid = el.dataset.otherId;
        if(oid){
          const other = document.getElementById(oid);
          if(other && other.offsetParent !== null){ // é¡¯ç¤ºä¸­æ‰è¦æ±‚
            const v = (other.value||'').trim();
            if(!v){
              return { ok:false, msg:'æ‚¨å‹¾é¸äº†ã€'+label+'ã€çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é¸é …ï¼Œè«‹è£œå……èªªæ˜' };
            }
          }
        }
      }
      return { ok:true };
    }

    // å·¥å…·ï¼šä»»ä½•é¡¯ç¤ºä¸­çš„ .other-input éœ€æœ‰å€¼ï¼ˆä¿éšªï¼‰
    function requireVisibleOthers(){
      const visibles = Array.from(document.querySelectorAll('.other-input')).filter(i=>{
        return (i.classList.contains('show') || i.offsetParent !== null);
      });
      for(const i of visibles){
        if(!(i.value||'').trim()){
          return { ok:false, msg:'æ‚¨é¸æ“‡äº†éœ€è£œå……çš„ã€Œå…¶ä»–ï¼ä»¥ä¸Šã€é …ç›®ï¼Œè«‹å¡«å¯«èªªæ˜' };
        }
      }
      return { ok:true };
    }

    // æˆåŠŸæ™‚å‰å¾€ä¸‹ä¸€æ­¥ï¼šè‹¥ <a id="next" href="..."> å‰‡å°å‘ï¼›å¦å‰‡æäº¤ form
    function proceed(){
      if (nextBtn.tagName.toLowerCase()==='a' && (nextBtn.dataset.nextHref || nextBtn.getAttribute('href'))) {
        window.location.href = (nextBtn.dataset.nextHref || nextBtn.getAttribute('href'));
      } else {
        // ä½¿ç”¨ novalidate çš„è¡¨å–®ï¼Œé¿å…åŸç”Ÿæ³¡æ³¡ï¼›çµ±ä¸€ alert é«”é©—
        if (form.requestSubmit) form.requestSubmit();
        else form.submit();
      }
    }

    nextBtn.addEventListener('click', function (e) {
      let r, valid = true, msg = '';

      // 1) å†·æ°£é¡å‹ï¼ˆradioï¼‰â€” åŒ…å«ã€Œæ˜¯å¦ç‚ºè®Šå½¢é‡‘å‰›ç³»åˆ—ã€ç­‰åŒçµ„åˆ¥
      r = requireRadio('ac_type','å†·æ°£é¡å‹');
      if(!r.ok){ valid=false; msg=r.msg; }

      // 2) æ¸…æ´—æ•¸é‡ï¼ˆradioï¼‰
      if(valid){
        r = requireRadio('ac_count','æ¸…æ´—æ•¸é‡');
        if(!r.ok){ valid=false; msg=r.msg; }
      }

      // 3) å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤ï¼ˆcheckbox ç¾¤çµ„ï¼‰ï¼šè‡³å°‘ä¸€å€‹
      if(valid){
        r = requireCheckbox('indoor_floor','å®¤å…§æ©Ÿæ‰€åœ¨æ¨“å±¤');
        if(!r.ok){ valid=false; msg=r.msg; }
      }

      // 4) å†·æ°£å“ç‰Œï¼ˆcheckbox ç¾¤çµ„ï¼‰ï¼šè‡³å°‘ä¸€å€‹
      if(valid){
        r = requireCheckbox('ac_brand','å†·æ°£å“ç‰Œ');
        if(!r.ok){ valid=false; msg=r.msg; }
      }

      // 5) é¡¯ç¤ºä¸­çš„ã€Œå…¶ä»–ã€è¼¸å…¥æ¡†éœ€å¡«å¯«
      if(valid){
        r = requireVisibleOthers();
        if(!r.ok){ valid=false; msg=r.msg; }
      }

      if(!valid){
        // é˜»æ­¢é è¨­èˆ‡å…¶ä»– click ç›£è½ï¼ˆé¿å…è¢«å…¶ä»–ç›£è½ submit/å°é ï¼‰
        e.preventDefault();
        e.stopImmediatePropagation();
        showOnceAlert(msg);
        return false;
      }else{
        // ä¸€å¾‹ç”±æˆ‘å€‘æŒæ§è·³è½‰ï¼Œé¿å…å…¶ä»–ç›£è½ä»‹å…¥
        e.preventDefault();
        e.stopImmediatePropagation();
        proceed();
        return false;
      }
    }, true /* useCapture: å…ˆæ–¼å…¶ä»–ç›£è½åŸ·è¡Œ */);
  });
</script>

<script>
// å…¨åŸŸæäº¤å®ˆé–€ï¼šå‡¡æ˜¯ #booking-form çš„æäº¤ï¼Œä¸€å¾‹èµ°åŒä¸€çµ„é©—è­‰ï¼›ä¸é€šéå°±æ””æˆª
document.addEventListener('submit', function(e){
  var form = e.target;
  if (!form || form.id !== 'booking-form') return;
  // è‹¥å‰›å‰›å·²å› ç‚º click å¤±æ•—è€Œè¨­ç½®äº† BLOCK_SUBMIT windowï¼Œé€™è£¡åªæ””æˆªï¼Œä¸å† alert
  if (Date.now() < (window.__BLOCK_SUBMIT_UNTIL__ || 0)) {
    e.preventDefault(); e.stopImmediatePropagation();
    return false;
  }
  var res = runValidation();
  if(!res.ok){
    e.preventDefault(); e.stopImmediatePropagation();
    showOnceAlert(res.msg);
    return false;
  }
}, true);
</script>

<script>
// æ›´åš´è¬¹çš„é˜²é‡è¤‡å½ˆçª— / æäº¤æŠ–å‹•
window.__ALERT_LAST_MSG__ = '';
window.__ALERT_LAST_TS__ = 0;
window.__BLOCK_SUBMIT_UNTIL__ = 0; // ç•¶ invalid æ™‚ï¼ŒçŸ­æ™‚é–“å…§æ“‹æ‰å¾ŒçºŒ submitï¼Œä¸å†é‡è¤‡ alert

function showOnceAlert(msg){
  var now = Date.now();
  // åŒè¨Šæ¯åœ¨ 2 ç§’å…§ä¸é‡è¤‡å½ˆ
  if (window.__ALERT_LAST_MSG__ === msg && (now - window.__ALERT_LAST_TS__) < 2000) {
    return;
  }
  window.__ALERT_LAST_MSG__ = msg;
  window.__ALERT_LAST_TS__ = now;
  alert(msg);
  // ä¹‹å¾Œ 1.2 ç§’å…§çš„ submit ä¸€å¾‹æ””ä¸‹ä½†ä¸å† alertï¼ˆé¿å… click èˆ‡ submit å…©æ¢è·¯å¾‘é‡è¤‡ï¼‰
  window.__BLOCK_SUBMIT_UNTIL__ = Date.now() + 1200;
}
</script>
</body>
</html>
