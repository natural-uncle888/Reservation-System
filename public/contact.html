<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="theme-color" content="#2563eb"/>
<title>聯繫名稱說明</title>
<link rel="icon" type="image/png" href="https://res.cloudinary.com/dijzndzw2/image/upload/v1757176751/logo-3_hddq08.png"/>

<!-- 完全獨立樣式：不依賴外部 CSS，不受 mobile-2col.css 影響 -->
<style>
  :root{
    --brand:#2563eb; --brand-700:#1e40af;
    --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --card:#f9fafb;
    --field-font:16px; --capsule-h:52px; --capsule-radius:18px; --capsule-border:2px;
  }
  html,body{height:100%}
  body{
    font-family:"Noto Sans TC",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;
    margin:0; color:var(--ink); background:#fff; font-size:16px; line-height:1.6;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  .wrap{max-width:960px;margin:0 auto;padding:20px 16px}
  h1{margin:0 0 8px;color:var(--brand)}
  .section{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:16px;margin:16px 0}
  .section h2{margin:0 0 10px;color:var(--brand);font-size:1.15rem}
  .row{display:grid;grid-template-columns:140px 1fr;gap:10px;align-items:center}
  @media (max-width: 520px){ .row{grid-template-columns:1fr;gap:6px} }

  /* 基本文字輸入體驗一致化 */
  input[type="text"],input[type="tel"],textarea,select,.other-input{
    padding:12px 12px;border:1.5px solid #d1d5db;border-radius:10px;width:100%;max-width:640px;
    font-size:var(--field-font);line-height:1.5;box-sizing:border-box;
  }
  input::placeholder,textarea::placeholder{color:#9ca3af}

  /* === 膠囊雙欄卡片（桌機與手機都 2 欄） === */
  .option-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;align-items:stretch}
  .option-grid > label.option-card{
    display:grid; grid-template-columns:24px 1fr; align-items:center; column-gap:10px;
    padding:10px 14px; min-height:var(--capsule-h);
    background:#fff; border:var(--capsule-border) solid var(--line); border-radius:var(--capsule-radius);
    box-shadow:0 2px 8px rgba(0,0,0,.04); font-size:1rem; line-height:1.25;
    cursor:pointer; user-select:none;
  }
  .option-grid > label.option-card:active{background:#eef2ff;border-color:var(--brand)}
  .option-grid > label.option-card.selected{border-color:var(--brand);background:#eef2ff;box-shadow:0 4px 12px rgba(37,99,235,.12)}
  .option-grid > label.option-card input[type="radio"],
  .option-grid > label.option-card input[type="checkbox"]{width:20px;height:20px;margin:0;accent-color:var(--brand)}
  .option-grid > label.option-card span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  /* 其他輸入框：預設隱藏，顯示時跨兩欄 */
  .other-input{display:none}
  .other-input.show{display:block;margin-top:8px;grid-column:1 / -1}

  /* 範例圖片：支援桌機與手機適當尺寸 */
  .example-img{width:clamp(220px,60vw,460px);height:auto;border:1px solid #d1d5db;border-radius:10px;display:block}
  @media (max-width:520px){.example-img{width:100%}}

  /* 導航按鈕一致化（final-booking 風格） */
  .nav{display:flex;gap:12px;margin-top:22px}
  .nav a{
    flex:1;text-align:center;padding:14px 16px;background:var(--brand);color:#fff;border-radius:12px;
    text-decoration:none;border:1px solid var(--brand);box-shadow:0 1px 6px rgba(37,99,235,.16);
    font-weight:600;transition:background .15s, transform .05s, box-shadow .15s;
  }
  .nav a:hover{background:var(--brand-700)}
  .nav a:active{transform:translateY(1px)}

  /* 保險：避免任何外部樣式干擾（若此檔仍被併入其他專案） */
  /* 使用相對精準選擇器與屬性覆寫 */
  :where(.option-grid){all:revert-layer}
  :where(.option-grid > label.option-card){all:revert-layer}
  /* 重新套用本檔規格 */
  .option-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;align-items:stretch}
  .option-grid > label.option-card{display:grid;grid-template-columns:24px 1fr;align-items:center;column-gap:10px;padding:10px 14px;min-height:var(--capsule-h);background:#fff;border:var(--capsule-border) solid var(--line);border-radius:var(--capsule-radius);box-shadow:0 2px 8px rgba(0,0,0,.04);font-size:1rem;line-height:1.25;cursor:pointer}
  .option-grid > label.option-card.selected{border-color:var(--brand);background:#eef2ff;box-shadow:0 4px 12px rgba(37,99,235,.12)}

/* === final-booking 按鈕一致化 === */
.nav{ display:flex; gap:12px; max-width:960px; margin:18px auto; padding:0 16px; }
.nav a, .nav button {
  flex:1; text-align:center; padding:12px 16px;
  background:var(--brand); color:#fff;
  border-radius:10px; text-decoration:none; border:none; cursor:pointer;
  font:500 16px/1.5 "Noto Sans TC", system-ui, -apple-system, BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}
.nav a:hover, .nav button:hover{ background: var(--brand-700); }

/* === 快速回首頁 FAB === */
.fab-home {
  position:fixed; right:18px; bottom:72px; width:54px; height:54px;
  background:var(--brand); color:#fff; border-radius:50%;
  box-shadow:0 2px 12px rgba(37,99,235,0.08);
  display:flex; align-items:center; justify-content:center;
  font-size:2.1em; z-index:1010; text-decoration:none;
  transition: background .13s, transform .13s; border:none;
}
.fab-home:active { background:#1d4ed8; transform:scale(0.92); }
@media (min-width:768px){ .fab-home { display:none; } }


/* === 修正桌機時圖片與輸入框重疊 === */
@media (min-width: 768px) {
  .row.social-row {
    grid-template-columns: 1fr; /* 單欄排列 */
  }
}

/* === 桌機：社群名稱區改為直向排列，避免 Grid 造成高度塌陷 === */
@media (min-width: 768px) {
  .row.social-row {
    display: block;           /* 直接使用標準文流 */
  }
  .row.social-row > * {
    margin-bottom: 10px;      /* 子元素間距 */
  }
  .row.social-row input[name="social_name"]{
    max-width: 420px;         /* 輸入框不會過寬 */
  }
}


/* === 強制修正（不分裝置）===
   避免任何外部樣式覆蓋，使用更高選擇器與 !important */
.section .row.social-row {
  display: block !important;      /* 直接改成直向堆疊 */
  grid-template-columns: none !important;
  min-height: auto !important;
}
.section .row.social-row > * {
  display: block !important;
  width: 100% !important;
  margin-bottom: 10px !important;
}
.section .row.social-row input[name="social_name"]{
  max-width: 420px !important;
}


/* === 手機修正：避免大樓(有電梯)/(無電梯) 吃字 === */
@media (max-width: 520px) {
  .option-grid > label.option-card span {
    white-space: normal !important;  /* 允許文字換行 */
  }
}


/* === 手機修正：說明文字縮小以符合畫面比例 === */
@media (max-width: 520px) {
  .intro {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }
}


/* === 必填標題紅色星號 (統一與 ac-booking) === */
.section h2.req::after {
  content: " *";
  color: #dc2626;
  margin-left: 4px;
  font-weight: 700;
}
/* row 內的小標題若標記 .req 也顯示星號 */
.row > .req::after {
  content: " *";
  color: #dc2626;
  margin-left: 4px;
  font-weight: 700;
}

</style>
</head>
<body>
<div class="wrap">
  <h1>聯繫名稱說明</h1>
  <div class="intro">
    <p>為了加快預約與資料比對速度，煩請您提供下列聯繫名稱：</p>
    <p>✅ 使用 LINE 聯繫者：請填寫您的 LINE 顯示名稱（非ID）</p>
    <p>✅ 使用 Facebook 粉絲專頁或私訊聯繫者：請填寫您或粉專的 Facebook 名稱</p>
    <p>📌 若未提供名稱，可能導致我們無法順利對應您的預約紀錄。敬請協助填寫，感謝您的配合與支持！</p>
  </div>

  <div class="section">
    <h2 class="req">與我們聯繫方式</h2>
    <div class="option-grid" id="contact-method">
      <label class="option-card"><input type="radio" name="contact_method" value="LINE"/><span>LINE</span></label>
      <label class="option-card"><input type="radio" name="contact_method" value="Facebook"/><span>Facebook</span></label>
      <label class="option-card"><input type="radio" name="contact_method" value="電話"/><span>電話</span></label>
      <label class="option-card"><input type="radio" name="contact_method" value="其他" data-other-id="contact_method_other"/><span>其他</span></label>
      <input type="text" class="other-input" id="contact_method_other" name="contact_method_other" placeholder="請輸入其他聯繫方式"/>
    </div>
    <details><summary>小提醒</summary><p>若偏好非電話聯繫，請在下方名稱處提供 LINE 或 FB 名稱。</p></details>
  </div>

  <div class="section">
    <h2 class="req">LINE 或 Facebook 名稱</h2>
    <div class="row social-row" style="align-items:center;">
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
        <div>名稱</div>
        <img src="imagesexample.jpg" alt="範例圖片：如何找到 LINE 或 Facebook 名稱" class="example-img"/>
      </div>
      <input type="text" name="social_name" placeholder="請輸入名稱（若選 LINE/FB 請務必填寫）"/>
    </div>
  </div>

  <div class="section">
    <h2 class="req">基本資料</h2>
    <div class="row">
      <div class="req">顧客姓名</div>
      <input type="text" name="name" placeholder="姓名"/>
    </div>
    <div class="row">
      <div class="req">聯繫電話</div>
      <input type="tel" name="phone" placeholder="手機或市話"/>
    </div>
    <div class="row">
      <div class="req">清洗保養地址</div>
      <input type="text" name="address" placeholder="縣市區 + 路名門牌"/>
    </div>
    <div class="row">
      <div class="req">居住地型態</div>
      <div class="option-grid" id="housing-type">
        <label class="option-card"><input type="radio" name="housing_type" value="透天屋"/><span>透天屋</span></label>
        <label class="option-card"><input type="radio" name="housing_type" value="大樓（有電梯）"/><span>大樓（有電梯）</span></label>
        <label class="option-card"><input type="radio" name="housing_type" value="大樓（無電梯）"/><span>大樓（無電梯）</span></label>
        <label class="option-card"><input type="radio" name="housing_type" value="其他" data-other-id="housing_type_other"/><span>其他</span></label>
        <input type="text" class="other-input" id="housing_type_other" name="housing_type_other" placeholder="請輸入型態"/>
      </div>
    </div>
    <div class="row">
      <div class="req">方便聯繫時間（可複選）</div>
      <div class="option-grid" id="contact-time">
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="平日"/><span>平日</span></label>
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="假日"/><span>假日</span></label>
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="上午"/><span>上午</span></label>
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="下午"/><span>下午</span></label>
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="晚上"/><span>晚上</span></label>
        <label class="option-card"><input type="checkbox" name="contact_time_preference" value="皆可"/><span>皆可</span></label>
      </div>
    </div>
    <details><summary>隱私說明</summary><p>聯繫資訊僅用於預約溝通與派工，不做其他用途。</p></details>
  </div>

  <div class="nav">
    <a href="other-service.html" id="back">返回上一步</a>
    <a href="final-booking.html" id="next">下一步</a>
  </div>
</div>

<script>
  (function(){
    const KEY='BOOKING_DATA';
    const $=s=>document.querySelector(s);
    const $$=s=>Array.prototype.slice.call(document.querySelectorAll(s));

    function save(part){
      try{
        const prev = JSON.parse(localStorage.getItem(KEY)||'{}');
        localStorage.setItem(KEY, JSON.stringify(Object.assign(prev, part)));
      }catch(e){}
    }
    function collect(root=document){
      const out={};
      $$('input[name],select[name],textarea[name]', root).forEach(el=>{
        const n=el.name; if(!n) return;
        if(el.type==='checkbox'){
          if(!el.checked) return;
          (out[n]||(out[n]=[])).push(el.value);
        }else if(el.type==='radio'){
          if(!el.checked) return;
          let v=el.value;
          const oid=el.dataset.otherId;
          if(oid){
            const extra=(document.getElementById(oid)?.value||'').trim();
            if(extra) v = v+'：'+extra;
          }
          out[n]=v;
        }else{
          const v=(el.value||'').trim();
          if(v) out[n]=v;
        }
      });
      return out;
    }

    // 其他輸入框顯示/隱藏控制（支援多組別）
    function setupOtherFieldToggle(){
      document.querySelectorAll('input[type="radio"][data-other-id]').forEach(function(radio){
        const targetId = radio.getAttribute('data-other-id');
        const target = document.getElementById(targetId);
        if(!target) return;

        function toggle(){
          // 只在同名群組中有被選時顯示
          const checkedOther = document.querySelector('input[type="radio"][name="'+radio.name+'"][data-other-id]:checked');
          if(checkedOther){
            target.classList.add('show');
            setTimeout(()=>target.focus(),0);
          }else{
            target.classList.remove('show');
            target.value='';
          }
        }
        // 初始狀態與事件
        toggle();
        document.querySelectorAll('input[type="radio"][name="'+radio.name+'"]').forEach(function(r){
          r.addEventListener('change', toggle);
        });
      });
    }

    // 卡片選中樣式控制（radio/checkbox）
    function setupCardSelection(){
      document.querySelectorAll('.option-grid').forEach(function(group){
        group.querySelectorAll('input[type="radio"],input[type="checkbox"]').forEach(function(input){
          function refresh(){
            if(input.type==="radio"){
              group.querySelectorAll('label.option-card').forEach(function(card){
                card.classList.remove('selected');
              });
              const checked = group.querySelector('input[type="radio"]:checked');
              if(checked){ checked.closest('label.option-card')?.classList.add('selected'); }
            }else{
              if(input.checked) input.closest('label.option-card')?.classList.add('selected');
              else input.closest('label.option-card')?.classList.remove('selected');
            }
          }
          input.addEventListener('change', refresh);
          // 初始狀態
          if(input.checked) input.closest('label.option-card')?.classList.add('selected');
        });
      });
    }

    document.addEventListener('change', ()=> save(collect()));
    ['back','next'].forEach(id=>{
      const a=document.getElementById(id);
      if(!a) return;
      a.addEventListener('click', ()=> save(collect()), {capture:true});
    });

    document.addEventListener('DOMContentLoaded', function(){
      setupOtherFieldToggle();
      setupCardSelection();
    });

    // 偵錯輔助
    window.debugContact=()=>collect();
    window.debugLS=()=>JSON.parse(localStorage.getItem(KEY)||'{}');
  })();
</script>
<a class="fab-home" aria-label="回首頁" href="index.html">🏠</a>

<script>
  // === 必填驗證 ===
  document.addEventListener('DOMContentLoaded', function () {
    const nextBtn = document.getElementById('next');

    nextBtn.addEventListener('click', function (e) {
      let valid = true;
      let msg = '';

      // 1️⃣ 驗證「與我們聯繫方式」必填
      const contactSelected = document.querySelector('input[name="contact_method"]:checked');
      if (!contactSelected) {
        valid = false;
        msg = '請選擇一個聯繫方式（LINE / Facebook / 電話 / 其他）';
      }

      // 2️⃣ 驗證「LINE 或 Facebook 名稱」若選 LINE / Facebook 時必填
      if (valid && (contactSelected?.value === 'LINE' || contactSelected?.value === 'Facebook')) {
        const socialName = document.querySelector('input[name="social_name"]');
        if (!socialName.value.trim()) {
          valid = false;
          msg = '您選擇了 ' + contactSelected.value + '，請填寫名稱';
        }
      }

      // 3️⃣ 驗證「顧客姓名」必填
      if (valid) {
        const nameField = document.querySelector('input[name="name"]');
        if (!nameField.value.trim()) {
          valid = false;
          msg = '請輸入顧客姓名';
        }
      }

      // 4️⃣ 驗證「聯繫電話」必填
      if (valid) {
        const phoneField = document.querySelector('input[name="phone"]');
        if (!phoneField.value.trim()) {
          valid = false;
          msg = '請輸入聯繫電話';
        }
      }

      // 5️⃣ 驗證「清洗保養地址」必填
      if (valid) {
        const addressField = document.querySelector('input[name="address"]');
        if (!addressField.value.trim()) {
          valid = false;
          msg = '請輸入清洗保養地址';
        }
      }

      // 6️⃣ 驗證「居住地型態」必填
      if (valid) {
        const housingSelected = document.querySelector('input[name="housing_type"]:checked');
        if (!housingSelected) {
          valid = false;
          msg = '請選擇居住地型態';
        }
      }


      // 7️⃣ 驗證「方便聯繫時間」必填
      if (valid) {
        const contactTimeChecked = document.querySelectorAll('input[name="contact_time_preference"]:checked');
        if (contactTimeChecked.length === 0) {
          valid = false;
          msg = '請至少選擇一個方便聯繫時間';
        }
      }
      if (!valid) {
        e.preventDefault(); // 阻止跳轉
        alert(msg);
      }
    });
  });
</script>

</body>
</html>
